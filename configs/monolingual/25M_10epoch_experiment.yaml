# Base configuration for a 10M parameter model training run
output_dir: "models/25M_10epoch"
train_dataset_path: "data/tokenized/25M/train"

# --- Model ---
tokenizer_path: "tokenizer/25M"
model_arch_type: "gpt2"
train_from_scratch: true
model_size_tag: "gpt2-100m"

# --- Training Hyperparameters ---
num_train_epochs: 1
per_device_train_batch_size: 8
gradient_accumulation_steps: 16
learning_rate: 5e-4
weight_decay: 0.01
max_grad_norm: 1.0
lr_scheduler_type: "cosine"
num_warmup_steps: 100

# --- Logging & Saving ---
logging_steps: 5
save_steps: 3

# --- Hardware & Seed ---
use_amp: true
num_workers: 4
seed: 42

checkpoint_schedule:
    - 1
    - 2
    - 4
    - 8
    - 16
    - 32
    - 64
    - 128
    - 192
    - 256
    - 320
    - 384
    - 448
    - 512
    - 640
    - 768
    - 896
    - 1024
    - 1194
    - 1365
    - 1479
    - 1593
    - 1707
    - 1878
    - 2048
    - 2182
    - 2316
    - 2450
    - 2584
    - 2718
    - 2853
    - 2987
    - 3121
    - 3334
    - 3548
    - 3761
    - 3974
    - 4188
    - 4401
    - 4614
    - 4828
    - 5041
    - 5255
    - 5468
    - 5681
    - 5895
    - 6108
    - 6321
    - 6535
    - 6748
    - 6749
    - 6750
    - 6752
    - 6756
    - 6764
    - 6780
    - 6812
    - 6876
    - 6940
    - 7004
    - 7068
    - 7132
    - 7196
    - 7260
    - 7388
    - 7516
    - 7644
    - 7772
    - 7942
    - 8113
    - 8227
    - 8341
    - 8455
    - 8626
    - 8796
    - 8930
    - 9064
    - 9198
    - 9332
    - 9466
    - 9601
    - 9735
    - 9869
    - 10082
    - 10296
    - 10509
    - 10722
    - 10936
    - 11149
    - 11362
    - 11576
    - 11789
    - 12003
    - 12216
    - 12429
    - 12643
    - 12856
    - 13069
    - 13283
    - 13496
    - 13497
    - 13498
    - 13500
    - 13504
    - 13512
    - 13528
    - 13560
    - 13624
    - 13688
    - 13752
    - 13816
    - 13880
    - 13944
    - 14008
    - 14136
    - 14264
    - 14392
    - 14520
    - 14690
    - 14861
    - 14975
    - 15089
    - 15203
    - 15374
    - 15544
    - 15678
    - 15812
    - 15946
    - 16080
    - 16214
    - 16349
    - 16483
    - 16617
    - 16830
    - 17044
    - 17257
    - 17470
    - 17684
    - 17897
    - 18110
    - 18324
    - 18537
    - 18751
    - 18964
    - 19177
    - 19391
    - 19604
    - 19817
    - 20031
    - 20244
    - 20245
    - 20246
    - 20248
    - 20252
    - 20260
    - 20276
    - 20308
    - 20372
    - 20436
    - 20500
    - 20564
    - 20628
    - 20692
    - 20756
    - 20884
    - 21012
    - 21140
    - 21268
    - 21438
    - 21609
    - 21723
    - 21837
    - 21951
    - 22122
    - 22292
    - 22426
    - 22560
    - 22694
    - 22828
    - 22962
    - 23097
    - 23231
    - 23365
    - 23578
    - 23792
    - 24005
    - 24218
    - 24432
    - 24645
    - 24858
    - 25072
    - 25285
    - 25499
    - 25712
    - 25925
    - 26139
    - 26352
    - 26565
    - 26779
    - 26992
    - 26993
    - 26994
    - 26996
    - 27000
    - 27008
    - 27024
    - 27056
    - 27120
    - 27184
    - 27248
    - 27312
    - 27376
    - 27440
    - 27504
    - 27632
    - 27760
    - 27888
    - 28016
    - 28186
    - 28357
    - 28471
    - 28585
    - 28699
    - 28870
    - 29040
    - 29174
    - 29308
    - 29442
    - 29576
    - 29710
    - 29845
    - 29979
    - 30113
    - 30326
    - 30540
    - 30753
    - 30966
    - 31180
    - 31393
    - 31606
    - 31820
    - 32033
    - 32247
    - 32460
    - 32673
    - 32887
    - 33100
    - 33313
    - 33527
    - 33740
    - 33741
    - 33742
    - 33744
    - 33748
    - 33756
    - 33772
    - 33804
    - 33868
    - 33932
    - 33996
    - 34060
    - 34124
    - 34188
    - 34252
    - 34380
    - 34508
    - 34636
    - 34764
    - 34934
    - 35105
    - 35219
    - 35333
    - 35447
    - 35618
    - 35788
    - 35922
    - 36056
    - 36190
    - 36324
    - 36458
    - 36593
    - 36727
    - 36861
    - 37074
    - 37288
    - 37501
    - 37714
    - 37928
    - 38141
    - 38354
    - 38568
    - 38781
    - 38995
    - 39208
    - 39421
    - 39635
    - 39848
    - 40061
    - 40275
    - 40488
    - 40489
    - 40490
    - 40492
    - 40496
    - 40504
    - 40520
    - 40552
    - 40616
    - 40680
    - 40744
    - 40808
    - 40872
    - 40936
    - 41000
    - 41128
    - 41256
    - 41384
    - 41512
    - 41682
    - 41853
    - 41967
    - 42081
    - 42195
    - 42366
    - 42536
    - 42670
    - 42804
    - 42938
    - 43072
    - 43206
    - 43341
    - 43475
    - 43609
    - 43822
    - 44036
    - 44249
    - 44462
    - 44676
    - 44889
    - 45102
    - 45316
    - 45529
    - 45743
    - 45956
    - 46169
    - 46383
    - 46596
    - 46809
    - 47023
    - 47236
    - 47237
    - 47238
    - 47240
    - 47244
    - 47252
    - 47268
    - 47300
    - 47364
    - 47428
    - 47492
    - 47556
    - 47620
    - 47684
    - 47748
    - 47876
    - 48004
    - 48132
    - 48260
    - 48430
    - 48601
    - 48715
    - 48829
    - 48943
    - 49114
    - 49284
    - 49418
    - 49552
    - 49686
    - 49820
    - 49954
    - 50089
    - 50223
    - 50357
    - 50570
    - 50784
    - 50997
    - 51210
    - 51424
    - 51637
    - 51850
    - 52064
    - 52277
    - 52491
    - 52704
    - 52917
    - 53131
    - 53344
    - 53557
    - 53771
    - 53984
    - 53985
    - 53986
    - 53988
    - 53992
    - 54000
    - 54016
    - 54048
    - 54112
    - 54176
    - 54240
    - 54304
    - 54368
    - 54432
    - 54496
    - 54624
    - 54752
    - 54880
    - 55008
    - 55178
    - 55349
    - 55463
    - 55577
    - 55691
    - 55862
    - 56032
    - 56166
    - 56300
    - 56434
    - 56568
    - 56702
    - 56837
    - 56971
    - 57105
    - 57318
    - 57532
    - 57745
    - 57958
    - 58172
    - 58385
    - 58598
    - 58812
    - 59025
    - 59239
    - 59452
    - 59665
    - 59879
    - 60092
    - 60305
    - 60519
    - 60732
    - 60733
    - 60734
    - 60736
    - 60740
    - 60748
    - 60764
    - 60796
    - 60860
    - 60924
    - 60988
    - 61052
    - 61116
    - 61180
    - 61244
    - 61372
    - 61500
    - 61628
    - 61756
    - 61926
    - 62097
    - 62211
    - 62325
    - 62439
    - 62610
    - 62780
    - 62914
    - 63048
    - 63182
    - 63316
    - 63450
    - 63585
    - 63719
    - 63853
    - 64066
    - 64280
    - 64493
    - 64706
    - 64920
    - 65133
    - 65346
    - 65560
    - 65773
    - 65987
    - 66200
    - 66413
    - 66627
    - 66840
    - 67053
    - 67267
    - 67480