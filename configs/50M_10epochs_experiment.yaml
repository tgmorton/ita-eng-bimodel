# Base configuration for a 10M parameter model training run
output_dir: "models/50M_10epoch"
train_dataset_path: "data/tokenized/50M/train"

# --- Model ---
tokenizer_path: "tokenizer/50M"
model_arch_type: "gpt2"
train_from_scratch: true
model_size_tag: "gpt2-100m"

# --- Training Hyperparameters ---
num_train_epochs: 1
per_device_train_batch_size: 8
gradient_accumulation_steps: 16
learning_rate: 5e-4
weight_decay: 0.01
max_grad_norm: 1.0
lr_scheduler_type: "cosine"
num_warmup_steps: 100

# --- Logging & Saving ---
logging_steps: 5
save_steps: 3

# --- Hardware & Seed ---
use_amp: true
num_workers: 4
seed: 42

checkpoint_schedule:
    - 1
    - 2
    - 4
    - 8
    - 16
    - 32
    - 64
    - 128
    - 192
    - 256
    - 320
    - 384
    - 448
    - 512
    - 640
    - 768
    - 896
    - 1024
    - 1109
    - 1194
    - 1280
    - 1365
    - 1479
    - 1593
    - 1707
    - 1792
    - 1878
    - 1963
    - 2048
    - 2115
    - 2182
    - 2249
    - 2316
    - 2383
    - 2450
    - 2517
    - 2584
    - 2718
    - 2786
    - 2853
    - 2987
    - 3121
    - 3228
    - 3334
    - 3441
    - 3548
    - 3654
    - 3761
    - 3868
    - 3974
    - 4081
    - 4188
    - 4294
    - 4401
    - 4508
    - 4614
    - 4721
    - 4828
    - 4934
    - 5041
    - 5148
    - 5255
    - 5362
    - 5468
    - 5574
    - 5681
    - 5788
    - 5895
    - 6002
    - 6108
    - 6214
    - 6321
    - 6428
    - 6535
    - 6642
    - 6748
    - 7001
    - 7254
    - 7507
    - 7760
    - 8014
    - 8267
    - 8520
    - 8773
    - 9026
    - 9279
    - 9532
    - 9786
    - 10039
    - 10292
    - 10545
    - 10798
    - 11051
    - 11304
    - 11557
    - 11810
    - 12064
    - 12317
    - 12570
    - 12823
    - 12824
    - 12825
    - 12827
    - 12831
    - 12839
    - 12855
    - 12887
    - 12951
    - 13015
    - 13079
    - 13143
    - 13207
    - 13271
    - 13335
    - 13463
    - 13591
    - 13719
    - 13847
    - 13932
    - 14017
    - 14103
    - 14188
    - 14302
    - 14416
    - 14530
    - 14615
    - 14701
    - 14786
    - 14871
    - 14938
    - 15005
    - 15072
    - 15139
    - 15206
    - 15273
    - 15340
    - 15407
    - 15541
    - 15609
    - 15676
    - 15810
    - 15944
    - 16051
    - 16157
    - 16264
    - 16371
    - 16477
    - 16584
    - 16691
    - 16797
    - 16904
    - 17011
    - 17117
    - 17224
    - 17331
    - 17437
    - 17544
    - 17651
    - 17757
    - 17864
    - 17971
    - 18078
    - 18185
    - 18291
    - 18397
    - 18504
    - 18611
    - 18718
    - 18825
    - 18931
    - 19037
    - 19144
    - 19251
    - 19358
    - 19465
    - 19571
    - 19824
    - 20077
    - 20330
    - 20583
    - 20837
    - 21090
    - 21343
    - 21596
    - 21849
    - 22102
    - 22355
    - 22609
    - 22862
    - 23115
    - 23368
    - 23621
    - 23874
    - 24127
    - 24380
    - 24633
    - 24887
    - 25140
    - 25393
    - 25646
    - 25647
    - 25648
    - 25650
    - 25654
    - 25662
    - 25678
    - 25710
    - 25774
    - 25838
    - 25902
    - 25966
    - 26030
    - 26094
    - 26158
    - 26286
    - 26414
    - 26542
    - 26670
    - 26755
    - 26840
    - 26926
    - 27011
    - 27125
    - 27239
    - 27353
    - 27438
    - 27524
    - 27609
    - 27694
    - 27761
    - 27828
    - 27895
    - 27962
    - 28029
    - 28096
    - 28163
    - 28230
    - 28364
    - 28432
    - 28499
    - 28633
    - 28767
    - 28874
    - 28980
    - 29087
    - 29194
    - 29300
    - 29407
    - 29514
    - 29620
    - 29727
    - 29834
    - 29940
    - 30047
    - 30154
    - 30260
    - 30367
    - 30474
    - 30580
    - 30687
    - 30794
    - 30901
    - 31008
    - 31114
    - 31220
    - 31327
    - 31434
    - 31541
    - 31648
    - 31754
    - 31860
    - 31967
    - 32074
    - 32181
    - 32288
    - 32394
    - 32647
    - 32900
    - 33153
    - 33406
    - 33660
    - 33913
    - 34166
    - 34419
    - 34672
    - 34925
    - 35178
    - 35432
    - 35685
    - 35938
    - 36191
    - 36444
    - 36697
    - 36950
    - 37203
    - 37456
    - 37710
    - 37963
    - 38216
    - 38469
    - 38470
    - 38471
    - 38473
    - 38477
    - 38485
    - 38501
    - 38533
    - 38597
    - 38661
    - 38725
    - 38789
    - 38853
    - 38917
    - 38981
    - 39109
    - 39237
    - 39365
    - 39493
    - 39578
    - 39663
    - 39749
    - 39834
    - 39948
    - 40062
    - 40176
    - 40261
    - 40347
    - 40432
    - 40517
    - 40584
    - 40651
    - 40718
    - 40785
    - 40852
    - 40919
    - 40986
    - 41053
    - 41187
    - 41255
    - 41322
    - 41456
    - 41590
    - 41697
    - 41803
    - 41910
    - 42017
    - 42123
    - 42230
    - 42337
    - 42443
    - 42550
    - 42657
    - 42763
    - 42870
    - 42977
    - 43083
    - 43190
    - 43297
    - 43403
    - 43510
    - 43617
    - 43724
    - 43831
    - 43937
    - 44043
    - 44150
    - 44257
    - 44364
    - 44471
    - 44577
    - 44683
    - 44790
    - 44897
    - 45004
    - 45111
    - 45217
    - 45470
    - 45723
    - 45976
    - 46229
    - 46483
    - 46736
    - 46989
    - 47242
    - 47495
    - 47748
    - 48001
    - 48255
    - 48508
    - 48761
    - 49014
    - 49267
    - 49520
    - 49773
    - 50026
    - 50279
    - 50533
    - 50786
    - 51039
    - 51292
    - 51293
    - 51294
    - 51296
    - 51300
    - 51308
    - 51324
    - 51356
    - 51420
    - 51484
    - 51548
    - 51612
    - 51676
    - 51740
    - 51804
    - 51932
    - 52060
    - 52188
    - 52316
    - 52401
    - 52486
    - 52572
    - 52657
    - 52771
    - 52885
    - 52999
    - 53084
    - 53170
    - 53255
    - 53340
    - 53407
    - 53474
    - 53541
    - 53608
    - 53675
    - 53742
    - 53809
    - 53876
    - 54010
    - 54078
    - 54145
    - 54279
    - 54413
    - 54520
    - 54626
    - 54733
    - 54840
    - 54946
    - 55053
    - 55160
    - 55266
    - 55373
    - 55480
    - 55586
    - 55693
    - 55800
    - 55906
    - 56013
    - 56120
    - 56226
    - 56333
    - 56440
    - 56547
    - 56654
    - 56760
    - 56866
    - 56973
    - 57080
    - 57187
    - 57294
    - 57400
    - 57506
    - 57613
    - 57720
    - 57827
    - 57934
    - 58040
    - 58293
    - 58546
    - 58799
    - 59052
    - 59306
    - 59559
    - 59812
    - 60065
    - 60318
    - 60571
    - 60824
    - 61078
    - 61331
    - 61584
    - 61837
    - 62090
    - 62343
    - 62596
    - 62849
    - 63102
    - 63356
    - 63609
    - 63862
    - 64115
    - 64116
    - 64117
    - 64119
    - 64123
    - 64131
    - 64147
    - 64179
    - 64243
    - 64307
    - 64371
    - 64435
    - 64499
    - 64563
    - 64627
    - 64755
    - 64883
    - 65011
    - 65139
    - 65224
    - 65309
    - 65395
    - 65480
    - 65594
    - 65708
    - 65822
    - 65907
    - 65993
    - 66078
    - 66163
    - 66230
    - 66297
    - 66364
    - 66431
    - 66498
    - 66565
    - 66632
    - 66699
    - 66833
    - 66901
    - 66968
    - 67102
    - 67236
    - 67343
    - 67449
    - 67556
    - 67663
    - 67769
    - 67876
    - 67983
    - 68089
    - 68196
    - 68303
    - 68409
    - 68516
    - 68623
    - 68729
    - 68836
    - 68943
    - 69049
    - 69156
    - 69263
    - 69370
    - 69477
    - 69583
    - 69689
    - 69796
    - 69903
    - 70010
    - 70117
    - 70223
    - 70329
    - 70436
    - 70543
    - 70650
    - 70757
    - 70863
    - 71116
    - 71369
    - 71622
    - 71875
    - 72129
    - 72382
    - 72635
    - 72888
    - 73141
    - 73394
    - 73647
    - 73901
    - 74154
    - 74407
    - 74660
    - 74913
    - 75166
    - 75419
    - 75672
    - 75925
    - 76179
    - 76432
    - 76685
    - 76938
    - 76939
    - 76940
    - 76942
    - 76946
    - 76954
    - 76970
    - 77002
    - 77066
    - 77130
    - 77194
    - 77258
    - 77322
    - 77386
    - 77450
    - 77578
    - 77706
    - 77834
    - 77962
    - 78047
    - 78132
    - 78218
    - 78303
    - 78417
    - 78531
    - 78645
    - 78730
    - 78816
    - 78901
    - 78986
    - 79053
    - 79120
    - 79187
    - 79254
    - 79321
    - 79388
    - 79455
    - 79522
    - 79656
    - 79724
    - 79791
    - 79925
    - 80059
    - 80166
    - 80272
    - 80379
    - 80486
    - 80592
    - 80699
    - 80806
    - 80912
    - 81019
    - 81126
    - 81232
    - 81339
    - 81446
    - 81552
    - 81659
    - 81766
    - 81872
    - 81979
    - 82086
    - 82193
    - 82300
    - 82406
    - 82512
    - 82619
    - 82726
    - 82833
    - 82940
    - 83046
    - 83152
    - 83259
    - 83366
    - 83473
    - 83580
    - 83686
    - 83939
    - 84192
    - 84445
    - 84698
    - 84952
    - 85205
    - 85458
    - 85711
    - 85964
    - 86217
    - 86470
    - 86724
    - 86977
    - 87230
    - 87483
    - 87736
    - 87989
    - 88242
    - 88495
    - 88748
    - 89002
    - 89255
    - 89508
    - 89761
    - 89762
    - 89763
    - 89765
    - 89769
    - 89777
    - 89793
    - 89825
    - 89889
    - 89953
    - 90017
    - 90081
    - 90145
    - 90209
    - 90273
    - 90401
    - 90529
    - 90657
    - 90785
    - 90870
    - 90955
    - 91041
    - 91126
    - 91240
    - 91354
    - 91468
    - 91553
    - 91639
    - 91724
    - 91809
    - 91876
    - 91943
    - 92010
    - 92077
    - 92144
    - 92211
    - 92278
    - 92345
    - 92479
    - 92547
    - 92614
    - 92748
    - 92882
    - 92989
    - 93095
    - 93202
    - 93309
    - 93415
    - 93522
    - 93629
    - 93735
    - 93842
    - 93949
    - 94055
    - 94162
    - 94269
    - 94375
    - 94482
    - 94589
    - 94695
    - 94802
    - 94909
    - 95016
    - 95123
    - 95229
    - 95335
    - 95442
    - 95549
    - 95656
    - 95763
    - 95869
    - 95975
    - 96082
    - 96189
    - 96296
    - 96403
    - 96509
    - 96762
    - 97015
    - 97268
    - 97521
    - 97775
    - 98028
    - 98281
    - 98534
    - 98787
    - 99040
    - 99293
    - 99547
    - 99800
    - 100053
    - 100306
    - 100559
    - 100812
    - 101065
    - 101318
    - 101571
    - 101825
    - 102078
    - 102331
    - 102584
    - 102585
    - 102586
    - 102588
    - 102592
    - 102600
    - 102616
    - 102648
    - 102712
    - 102776
    - 102840
    - 102904
    - 102968
    - 103032
    - 103096
    - 103224
    - 103352
    - 103480
    - 103608
    - 103693
    - 103778
    - 103864
    - 103949
    - 104063
    - 104177
    - 104291
    - 104376
    - 104462
    - 104547
    - 104632
    - 104699
    - 104766
    - 104833
    - 104900
    - 104967
    - 105034
    - 105101
    - 105168
    - 105302
    - 105370
    - 105437
    - 105571
    - 105705
    - 105812
    - 105918
    - 106025
    - 106132
    - 106238
    - 106345
    - 106452
    - 106558
    - 106665
    - 106772
    - 106878
    - 106985
    - 107092
    - 107198
    - 107305
    - 107412
    - 107518
    - 107625
    - 107732
    - 107839
    - 107946
    - 108052
    - 108158
    - 108265
    - 108372
    - 108479
    - 108586
    - 108692
    - 108798
    - 108905
    - 109012
    - 109119
    - 109226
    - 109332
    - 109585
    - 109838
    - 110091
    - 110344
    - 110598
    - 110851
    - 111104
    - 111357
    - 111610
    - 111863
    - 112116
    - 112370
    - 112623
    - 112876
    - 113129
    - 113382
    - 113635
    - 113888
    - 114141
    - 114394
    - 114648
    - 114901
    - 115154
    - 115407
    - 115408
    - 115409
    - 115411
    - 115415
    - 115423
    - 115439
    - 115471
    - 115535
    - 115599
    - 115663
    - 115727
    - 115791
    - 115855
    - 115919
    - 116047
    - 116175
    - 116303
    - 116431
    - 116516
    - 116601
    - 116687
    - 116772
    - 116886
    - 117000
    - 117114
    - 117199
    - 117285
    - 117370
    - 117455
    - 117522
    - 117589
    - 117656
    - 117723
    - 117790
    - 117857
    - 117924
    - 117991
    - 118125
    - 118193
    - 118260
    - 118394
    - 118528
    - 118635
    - 118741
    - 118848
    - 118955
    - 119061
    - 119168
    - 119275
    - 119381
    - 119488
    - 119595
    - 119701
    - 119808
    - 119915
    - 120021
    - 120128
    - 120235
    - 120341
    - 120448
    - 120555
    - 120662
    - 120769
    - 120875
    - 120981
    - 121088
    - 121195
    - 121302
    - 121409
    - 121515
    - 121621
    - 121728
    - 121835
    - 121942
    - 122049
    - 122155
    - 122408
    - 122661
    - 122914
    - 123167
    - 123421
    - 123674
    - 123927
    - 124180
    - 124433
    - 124686
    - 124939
    - 125193
    - 125446
    - 125699
    - 125952
    - 126205
    - 126458
    - 126711
    - 126964
    - 127217
    - 127471
    - 127724
    - 127977
    - 128230